name: Update DSA Progress

on:
  push:
    paths:
      - 'dsa-data.json'
  workflow_dispatch: # Allow manual triggering

jobs:
  update-portfolio:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v3
      
    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
        
    - name: Install dependencies
      run: npm install
      
    - name: Validate JSON data
      run: |
        node -e "
          try {
            const data = JSON.parse(require('fs').readFileSync('dsa-data.json', 'utf8'));
            console.log('âœ… JSON is valid');
            console.log('ğŸ“Š Total problems:', data.totalProblems);
            console.log('ğŸ“… Last updated:', data.lastUpdated);
          } catch (e) {
            console.error('âŒ Invalid JSON:', e.message);
            process.exit(1);
          }
        "
        
    - name: Deploy to portfolio (if needed)
      run: |
        echo "ğŸš€ DSA data updated successfully!"
        echo "ğŸ“ˆ New problem count: $(node -e "console.log(JSON.parse(require('fs').readFileSync('dsa-data.json', 'utf8')).totalProblems)")"
        echo "ğŸ”„ Your portfolio will automatically fetch this data within 24 hours"
        
    - name: Notify success
      run: |
        echo "ğŸ‰ DSA progress updated successfully!"
        echo "ğŸ“Š Check your portfolio to see the changes"


